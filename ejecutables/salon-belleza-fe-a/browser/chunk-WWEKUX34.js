import{a as z}from"./chunk-VG6MFNQK.js";import{a as K}from"./chunk-URET6IV6.js";import{a as P,b as m,c as y,d as x,e as A,g as q,h as L,i as M,j as O,k,l as G,m as j,n as B,o as U,p as H}from"./chunk-QEQSUI4L.js";import"./chunk-K7U5DLAY.js";import{c as D,f as N}from"./chunk-H2DLJ7WX.js";import{Ka as n,La as V,Va as u,Vb as R,W as C,Xa as s,Y as b,_a as c,cb as a,db as l,eb as p,fa as _,fb as T,ga as F,gb as E,ha as S,hb as h,qb as r,vb as w,xb as d}from"./chunk-TQRRVTAY.js";import"./chunk-2VMXMS7J.js";var f=(i,o)=>({"mb-5":i,"mb-3":o}),v=(i,o)=>({"is-invalid":i,"is-valid":o});function $(i,o){i&1&&r(0," Ingrese un nombre ")}function Q(i,o){i&1&&r(0," Ingrese un nombre valido ")}function W(i,o){i&1&&r(0," Ingrese un dpi ")}function X(i,o){i&1&&r(0," Ingrese un dpi valido ")}function Y(i,o){if(i&1){let t=T();a(0,"div",5)(1,"label",21),r(2,"Rol del usuario"),l(),a(3,"select",22),E("change",function(g){_(t);let I=h();return F(I.rolSeleccionado(g))}),a(4,"option",23),r(5,"Administrador"),l(),a(6,"option",24),r(7,"Encargado del area de marketing"),l(),a(8,"option",25),r(9,"Encargado del area de servicios"),l(),a(10,"option",26),r(11,"Encargado de atender clientes"),l()(),a(12,"div",8),r(13,"seleccione un rol"),l()()}if(i&2){let t=h();s("ngClass",d(2,f,t.faltaRol(),!t.faltaRol())),n(3),s("ngClass",d(5,v,t.faltaRol(),t.esRolValido()))}}function Z(i,o){i&1&&r(0," Ingrese un telefono ")}function ee(i,o){i&1&&r(0," Ingrese un telefono valido ")}function ie(i,o){i&1&&r(0," Ingrese un email ")}function oe(i,o){i&1&&r(0," Ingrese un email valido ")}function te(i,o){i&1&&r(0," Ingrese nuevamente la contrase\xF1a ")}function re(i,o){i&1&&r(0," Las contrase\xF1as no coinciden ")}function ae(i,o){i&1&&r(0," Ingrese la foto del empleado ")}function ne(i,o){i&1&&r(0," foto demasiado grande, escoja una menor a 64kb ")}function le(i,o){i&1&&r(0," Ingrese una descripcion del empleado ")}function se(i,o){i&1&&r(0," descripcion demasiado corta ")}function de(i,o){if(i&1){let t=T();a(0,"div",5)(1,"label",11),r(2,"Fotografia"),l(),a(3,"input",27),E("change",function(g){_(t);let I=h();return F(I.archivoSeleccionado(g))})("click",function(){_(t);let g=h();return F(g.inputFotoTocado=!0)}),l(),a(4,"div",8),u(5,ae,1,0)(6,ne,1,0),l()(),a(7,"div",5)(8,"label",13),r(9,"Descripcion profesional"),l(),p(10,"textarea",28),a(11,"div",8),u(12,le,1,0)(13,se,1,0),l()()}if(i&2){let t=h();s("ngClass",d(6,f,t.faltaFoto(),!t.faltaFoto())),n(3),s("ngClass",d(9,v,t.faltaFoto(),t.esFotoValida())),n(2),c(t.faltaFoto()?5:6),n(2),s("ngClass",d(12,f,t.faltaDescripcion()||t.esDescripcionInvalida(),!(t.faltaDescripcion()||t.esDescripcionInvalida()))),n(3),s("ngClass",d(15,v,t.faltaDescripcion()||t.esDescripcionInvalida(),t.esDescripcionValida())),n(2),c(t.faltaDescripcion()?12:13)}}function me(i,o){i&1&&(a(0,"div",19)(1,"a",29),S(),a(2,"svg",30),p(3,"path",31),l(),r(4," Iniciar sesion "),l()())}var J=class i{constructor(o){this.formBuilder=o;this.registroForm=this.formBuilder.group({nombre:["",[m.required,m.minLength(6)]],dpi:["",[m.required,m.pattern(/^[1-9]\d{12}$/)]],telefono:["",[m.required,m.minLength(8),m.maxLength(20)]],correo:["",[m.required,m.email]],contrase\u00F1a:["",[m.required,m.minLength(6)]],confirmacionContrase\u00F1a:["",[m.required]]}),this.cliente||this.registroForm.addControl("rol",this.formBuilder.control("",[m.required])),this._validadorForm=new K(this.registroForm)}registroForm;_validadorForm;_usuarioServicio=C(z);route=C(D);usuario;foto=null;inputFotoTocado=!1;cliente;empleado=!1;ngOnInit(){this.cliente=this.route.snapshot.data.cliente??!0}informacion=C(U);enviar(){this.cliente?this.enviarCliente():this.enviarEmpleado()}faltaRol(){return this._validadorForm.hasErrors("rol","required")}esRolValido(){return this._validadorForm.esValido("rol")}enviarEmpleado(){if(this.registroForm.valid&&this.esPasswordIgualValido()){if(this.usuario=this.registroForm.value,this.empleado){if(this.foto===null){this.informacion.informarError("ingresar correctamente los datos solicitados"),this.inputFotoTocado=!0,this.registroForm.markAllAsTouched();return}let o=new FormData;o.append("detalles",JSON.stringify(this.usuario)),o.append("foto",this.foto),this._usuarioServicio.registrarEmpleado(o).subscribe({next:()=>{this.registroForm.reset(),this.foto=null,this.inputFotoTocado=!1,this.empleado=!1,this.registroForm.contains("descripcion")&&this.registroForm.removeControl("descripcion")},error:t=>{console.log(t),this.informacion.informarError(t.error.mensaje||"Error al registrar el usuario"),this.registroForm.markAllAsTouched()}});return}this._usuarioServicio.registrarUsuario(this.usuario).subscribe({next:()=>{this.registroForm.reset(),this.foto=null,this.inputFotoTocado=!1},error:o=>{console.log(o),this.informacion.informarError(o.error.mensaje||"Error al registrar el usuario"),this.registroForm.markAllAsTouched(),this.inputFotoTocado=!0}})}else this.informacion.informarError("Ingrese todos los datos correctamente"),this.registroForm.markAllAsTouched(),console.log("Formulario inv\xE1lido"),this.empleado&&(this.inputFotoTocado=!0)}enviarCliente(){this.registroForm.valid&&this.esPasswordIgualValido()?(console.log(this.registroForm.value),this.usuario=this.registroForm.value,this.usuario.rol="CLIENTE",this._usuarioServicio.registrarUsuario(this.usuario).subscribe({next:()=>{this.usuario.activo=!1,this._usuarioServicio.redireccionarUsuario(this.usuario)},error:o=>{console.log(o),this.informacion.informarError(o.error.mensaje||"Error al registrar el usuario"),this.registroForm.markAllAsTouched()}})):(this.informacion.informarError("Ingrese todos los datos correctamente"),this.registroForm.markAllAsTouched(),console.log("Formulario inv\xE1lido"))}archivoSeleccionado(o){let t=o.target;t.files&&t.files.length>0?this.foto=t.files[0]:this.foto=null}rolSeleccionado(o){o.target.value==="EMPLEADO"?(this.empleado=!0,this.registroForm.contains("descripcion")||this.registroForm.addControl("descripcion",this.formBuilder.control("",[m.required,m.minLength(20)]))):(this.empleado=!1,this.inputFotoTocado=!1,this.foto=null,this.registroForm.contains("descripcion")&&this.registroForm.removeControl("descripcion"))}faltaNombre(){return this._validadorForm.hasErrors("nombre","required")}esNombreInvalido(){return this._validadorForm.hasErrors("nombre","minlength")}esNombreValido(){return this._validadorForm.esValido("nombre")}faltaDpi(){return this._validadorForm.hasErrors("dpi","required")}esDpiInvalido(){return this._validadorForm.hasErrors("dpi","pattern")}esDpiValido(){return this._validadorForm.esValido("dpi")}faltaTelefono(){return this._validadorForm.hasErrors("telefono","required")}esTelefonoInvalido(){return this._validadorForm.hasErrors("telefono","minlength")||this._validadorForm.hasErrors("telefono","maxlength")}esTelefonoValido(){return this._validadorForm.esValido("telefono")}faltaEmail(){return this._validadorForm.hasErrors("correo","required")}esEmailInvalido(){return this._validadorForm.hasErrors("correo","email")}esEmailValido(){return this._validadorForm.esValido("correo")}esPasswordInvalido(){return this._validadorForm.hasErrors("contrase\xF1a","minlength")}faltaPassword(){return this._validadorForm.hasErrors("contrase\xF1a","required")}esPasswordValido(){return this._validadorForm.esValido("contrase\xF1a")}esConfirmacionPasswordInvalido(){return this._validadorForm.hasErrors("confirmacionContrase\xF1a","minlength")}faltaConfirmacionPassword(){return this._validadorForm.hasErrors("confirmacionContrase\xF1a","required")}esConfirmacionPasswordValido(){return this._validadorForm.esValido("confirmacionContrase\xF1a")}esPasswordIgual(){return this.registroForm.get("contrase\xF1a")?.value===this.registroForm.get("confirmacionContrase\xF1a")?.value}esPasswordIgualValido(){return this.esPasswordIgual()&&this.esConfirmacionPasswordValido()&&this.esPasswordValido()}esPasswordIgualInvalido(){return!this.esPasswordIgual()&&this.esConfirmacionPasswordValido()&&this.esPasswordValido()}faltaFoto(){return this.foto===null&&this.inputFotoTocado}esFotoValida(){return this.foto!==null&&this.inputFotoTocado}faltaDescripcion(){return this._validadorForm.hasErrors("descripcion","required")}esDescripcionInvalida(){return this._validadorForm.hasErrors("descripcion","minlength")}esDescripcionValida(){return this._validadorForm.esValido("descripcion")}static \u0275fac=function(t){return new(t||i)(V(j))};static \u0275cmp=b({type:i,selectors:[["app-registro"]],standalone:!0,features:[w],decls:54,vars:58,consts:[[1,"d-flex","justify-content-center"],[1,"card","w-25","m-3","shadow"],[1,"card-body","custom-card"],[1,"card-title","text-center","mb-3"],["novalidate","",1,"needs-validation",3,"submit","formGroup"],[1,"position-relative",3,"ngClass"],["for","validationTooltip03",1,"form-label"],["type","text","id","validationTooltip03","formControlName","nombre","required","",1,"form-control",3,"ngClass"],[1,"invalid-tooltip"],["for","validationTooltip04",1,"form-label"],["type","text","id","validationTooltip04","formControlName","dpi","required","",1,"form-control",3,"ngClass"],["for","validationTooltip05",1,"form-label"],["type","text","id","validationTooltip05","formControlName","telefono","required","",1,"form-control",3,"ngClass"],["for","validationTooltip01",1,"form-label"],["type","email","id","validationTooltip01","formControlName","correo","required","",1,"form-control",3,"ngClass"],["for","validationTooltip02",1,"form-label"],["type","password","id","validationTooltip02","formControlName","contrase\xF1a","required","",1,"form-control",3,"ngClass"],["for","validationTooltip07",1,"form-label"],["type","password","id","validationTooltip07","formControlName","confirmacionContrase\xF1a","required","",1,"form-control",3,"ngClass"],[1,"mb-3","d-flex","justify-content-center"],["type","submit",1,"custom-button"],["for","rol",1,"form-label"],["aria-label","Default select example","required","","formControlName","rol",1,"form-select","is-valid",3,"change","ngClass"],["value","ADMINISTRADOR"],["value","MARKETING"],["value","SERVICIOS"],["value","EMPLEADO"],["type","file","accept","image/*","id","validationTooltip05","required","",1,"form-control",3,"change","click","ngClass"],["rows","3","id","validationTooltip01","formControlName","descripcion","required","",1,"form-control",3,"ngClass"],["routerLink","/inicio",1,"icon-link"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-person"],["d","M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"]],template:function(t,e){t&1&&(p(0,"app-informacion"),a(1,"div",0)(2,"div",1)(3,"div",2)(4,"h5",3),r(5,"Registro"),l(),a(6,"form",4),E("submit",function(){return e.enviar()}),a(7,"div",5)(8,"label",6),r(9,"Nombre"),l(),p(10,"input",7),a(11,"div",8),u(12,$,1,0)(13,Q,1,0),l()(),a(14,"div",5)(15,"label",9),r(16,"DPI"),l(),p(17,"input",10),a(18,"div",8),u(19,W,1,0)(20,X,1,0),l()(),u(21,Y,14,8,"div",5),a(22,"div",5)(23,"label",11),r(24,"Telefono"),l(),p(25,"input",12),a(26,"div",8),u(27,Z,1,0)(28,ee,1,0),l()(),a(29,"div",5)(30,"label",13),r(31,"Email"),l(),p(32,"input",14),a(33,"div",8),u(34,ie,1,0)(35,oe,1,0),l()(),a(36,"div",5)(37,"label",15),r(38,"Contrase\xF1a"),l(),p(39,"input",16),a(40,"div",8),r(41,"Ingrese su contrase\xF1a"),l()(),a(42,"div",5)(43,"label",17),r(44,"Confirmar contrase\xF1a"),l(),p(45,"input",18),a(46,"div",8),u(47,te,1,0)(48,re,1,0),l()(),u(49,de,14,18),a(50,"div",19)(51,"button",20),r(52,"Registrarse"),l()(),u(53,me,5,0,"div",19),l()()()()),t&2&&(n(6),s("formGroup",e.registroForm),n(),s("ngClass",d(22,f,e.faltaNombre()||e.esNombreInvalido(),!(e.faltaNombre()||e.esNombreInvalido()))),n(3),s("ngClass",d(25,v,e.faltaNombre()||e.esNombreInvalido(),e.esNombreValido())),n(2),c(e.faltaNombre()?12:13),n(2),s("ngClass",d(28,f,e.faltaDpi()||e.esDpiInvalido(),!(e.faltaDpi()||e.esDpiInvalido()))),n(3),s("ngClass",d(31,v,e.faltaDpi()||e.esDpiInvalido(),e.esDpiValido())),n(2),c(e.faltaDpi()?19:20),n(2),c(e.cliente?-1:21),n(),s("ngClass",d(34,f,e.faltaTelefono()||e.esTelefonoInvalido(),!(e.faltaTelefono()||e.esTelefonoInvalido()))),n(3),s("ngClass",d(37,v,e.faltaTelefono()||e.esTelefonoInvalido(),e.esTelefonoValido())),n(2),c(e.faltaTelefono()?27:28),n(2),s("ngClass",d(40,f,e.faltaEmail()||e.esEmailInvalido(),!(e.faltaEmail()||e.esEmailInvalido()))),n(3),s("ngClass",d(43,v,e.faltaEmail()||e.esEmailInvalido(),e.esEmailValido())),n(2),c(e.faltaEmail()?34:-1),n(),c(e.esEmailInvalido()?35:-1),n(),s("ngClass",d(46,f,e.faltaPassword(),!e.faltaPassword())),n(3),s("ngClass",d(49,v,e.faltaPassword(),e.esPasswordValido())),n(3),s("ngClass",d(52,f,e.faltaConfirmacionPassword()||e.esPasswordIgualInvalido(),!(e.faltaConfirmacionPassword()||e.esPasswordIgualInvalido()))),n(3),s("ngClass",d(55,v,e.faltaConfirmacionPassword()||e.esPasswordIgualInvalido(),e.esPasswordIgualValido())),n(2),c(e.faltaConfirmacionPassword()?47:48),n(2),c(e.empleado?49:-1),n(4),c(e.cliente?53:-1))},dependencies:[B,A,O,k,P,M,y,x,G,q,L,R,N,H]})};export{J as RegistroComponent};
