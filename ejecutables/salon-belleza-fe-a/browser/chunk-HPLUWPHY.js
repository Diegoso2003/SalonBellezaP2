import{a as W}from"./chunk-5SBUVE6J.js";import{a as Z}from"./chunk-2ZKC73YP.js";import{a as Y}from"./chunk-2MZD7B76.js";import{a as U,b as X}from"./chunk-OCPFQW2A.js";import{a as Q}from"./chunk-URET6IV6.js";import{a as j,b as I,c as P,d as H,e as $,g as z,h as k,m as O,n as J,o as K,p as L}from"./chunk-QEQSUI4L.js";import"./chunk-K7U5DLAY.js";import{c as B}from"./chunk-H2DLJ7WX.js";import{$a as R,Ka as r,La as D,Va as f,Vb as A,W as b,Xa as m,Y as p,_a as C,ab as g,bb as F,cb as o,db as n,eb as l,gb as w,ha as M,hb as G,qb as a,rb as u,sb as v,vb as c,xb as d,yb as N,zb as q}from"./chunk-TQRRVTAY.js";import"./chunk-2VMXMS7J.js";var y=(t,i)=>({"mb-5":t,"mb-3":i}),E=(t,i)=>({"is-invalid":t,"is-valid":i});function te(t,i){t&1&&a(0," Reporte de los 5 clientes que mas han gastado ")}function ie(t,i){t&1&&a(0," Reporte de los 5 clientes que menos han gastado ")}var x=class t{constructor(i){this.formBuilder=i;this.clienteGastosForm=this.formBuilder.group({fechaInicio:["",[I.pattern(/^\d{4}-\d{2}-\d{2}$/)]],fechaFin:["",[I.pattern(/^\d{4}-\d{2}-\d{2}$/)]],dpi:["",[I.pattern(/^[1-9]\d{12}$/)]]}),this.validador=new Q(this.clienteGastosForm)}clienteGastosForm;validador;adminService=b(W);informacion=b(K);clienteMasGasto;informeCambio;gastosClienteArreglo;enviar(){this.informeCambio.vaciarFechas(),this.clienteGastosForm.valid?this.mandarInfo():(this.informacion.informarError("ingresar correctamente los datos ingresados"),this.clienteGastosForm.markAllAsTouched())}mandarInfo(){let i=this.armarConsulta();this.clienteMasGasto?this.adminService.obtenerClienteMasGasto(i).subscribe({next:e=>{this.agregarReporte(e),this.informarCambio(i)},error:e=>{console.log(e),this.informacion.informarError(e.error.mensaje||"error al conseguir los clientes que mas gastan")}}):this.adminService.obtenerClienteMenorGasto(i).subscribe({next:e=>{this.agregarReporte(e),this.informarCambio(i)},error:e=>{console.log(e),this.informacion.informarError(e.error.mensaje||"error al conseguir los clientes que menos gastan")}})}agregarReporte(i){this.gastosClienteArreglo.length=0,this.gastosClienteArreglo.push(...i)}informarCambio(i){this.informeCambio.setFechaInicio(i.fechaInicio||""),this.informeCambio.setFechaFin(i.fechaFin||""),this.informeCambio.setCampo(i.campo||""),this.informeCambio.setCambio(!0)}armarConsulta(){let i=this.clienteGastosForm.get("fechaInicio")?.value,e=this.clienteGastosForm.get("fechaFin")?.value,s=this.clienteGastosForm.get("dpi")?.value,h={};return i!==""&&(h.fechaInicio=i),e!==""&&(h.fechaFin=e),s!==""&&(h.campo=s),h}esFechaInicioInvalida(){return this.validador.hasErrors("fechaInicio","pattern")}esFechaFinInvalida(){return this.validador.hasErrors("fechaFin","pattern")}esFechaInicioValida(){return this.validador.esValido("fechaInicio")}esFechaFinValida(){return this.validador.esValido("fechaFin")}esDpiInvalido(){return this.validador.hasErrors("dpi","pattern")}esDpiValido(){return this.validador.esValido("dpi")}static \u0275fac=function(e){return new(e||t)(D(O))};static \u0275cmp=p({type:t,selectors:[["app-form-cliente-gastos"]],inputs:{clienteMasGasto:"clienteMasGasto",informeCambio:"informeCambio",gastosClienteArreglo:"gastosClienteArreglo"},standalone:!0,features:[c],decls:28,vars:26,consts:[[1,"d-flex","align-items-center","justify-content-center"],[1,"card","w-25","m-3","shadow"],[1,"card-body","custom-card"],[1,"card-title","text-center","mb-3"],["novalidate","",1,"needs-validation",3,"submit","formGroup"],[1,"position-relative",3,"ngClass"],["for","validationTooltip02",1,"form-label"],["type","date","id","validationTooltip02","formControlName","fechaInicio",1,"form-control",3,"ngClass"],[1,"invalid-tooltip"],["for","validationTooltip01",1,"form-label"],["type","date","id","validationTooltip01","formControlName","fechaFin",1,"form-control",3,"ngClass"],["for","validationTooltip04",1,"form-label"],["type","text","id","validationTooltip04","formControlName","dpi",1,"form-control",3,"ngClass"],[1,"mb-3","d-flex","justify-content-center"],["type","submit",1,"custom-button"]],template:function(e,s){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),f(4,te,1,0)(5,ie,1,0),n(),o(6,"form",4),w("submit",function(){return s.enviar()}),o(7,"div",5)(8,"label",6),a(9,"Fecha inicio"),n(),l(10,"input",7),o(11,"div",8),a(12,"Ingrese una fecha valida"),n()(),o(13,"div",5)(14,"label",9),a(15,"Fecha fin"),n(),l(16,"input",10),o(17,"div",8),a(18,"Ingrese una fecha valida"),n()(),o(19,"div",5)(20,"label",11),a(21,"DPI"),n(),l(22,"input",12),o(23,"div",8),a(24,"Ingrese un dpi valido"),n()(),o(25,"div",13)(26,"button",14),a(27,"Realizar consulta"),n()()()()()()),e&2&&(r(4),C(s.clienteMasGasto?4:5),r(2),m("formGroup",s.clienteGastosForm),r(),m("ngClass",d(8,y,s.esFechaInicioInvalida(),!s.esFechaInicioInvalida())),r(3),m("ngClass",d(11,E,s.esFechaInicioInvalida(),s.esFechaInicioValida())),r(3),m("ngClass",d(14,y,s.esFechaFinInvalida(),!s.esFechaFinInvalida())),r(3),m("ngClass",d(17,E,s.esFechaFinInvalida(),s.esFechaFinValida())),r(3),m("ngClass",d(20,y,s.esDpiInvalido(),!s.esDpiInvalido())),r(3),m("ngClass",d(23,E,s.esDpiInvalido(),s.esDpiValido())))},dependencies:[A,J,$,j,P,H,z,k]})};var _=class t{clienteMasGasto;informeCambio;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-boton-importar-cliente-gastos"]],inputs:{clienteMasGasto:"clienteMasGasto",informeCambio:"informeCambio"},standalone:!0,features:[c],decls:4,vars:0,consts:[["type","button",1,"btn","btn-sm","custom-button"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-filetype-pdf"],["fill-rule","evenodd","d","M14 4.5V14a2 2 0 0 1-2 2h-1v-1h1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5zM1.6 11.85H0v3.999h.791v-1.342h.803q.43 0 .732-.173.305-.175.463-.474a1.4 1.4 0 0 0 .161-.677q0-.375-.158-.677a1.2 1.2 0 0 0-.46-.477q-.3-.18-.732-.179m.545 1.333a.8.8 0 0 1-.085.38.57.57 0 0 1-.238.241.8.8 0 0 1-.375.082H.788V12.48h.66q.327 0 .512.181.185.183.185.522m1.217-1.333v3.999h1.46q.602 0 .998-.237a1.45 1.45 0 0 0 .595-.689q.196-.45.196-1.084 0-.63-.196-1.075a1.43 1.43 0 0 0-.589-.68q-.396-.234-1.005-.234zm.791.645h.563q.371 0 .609.152a.9.9 0 0 1 .354.454q.118.302.118.753a2.3 2.3 0 0 1-.068.592 1.1 1.1 0 0 1-.196.422.8.8 0 0 1-.334.252 1.3 1.3 0 0 1-.483.082h-.563zm3.743 1.763v1.591h-.79V11.85h2.548v.653H7.896v1.117h1.606v.638z"]],template:function(e,s){e&1&&(o(0,"button",0),a(1," Importar reporte "),M(),o(2,"svg",1),l(3,"path",2),n()())}})};var oe=(t,i)=>i.idCita;function ne(t,i){if(t&1&&(o(0,"tr")(1,"td"),a(2),n(),o(3,"td"),a(4),n(),o(5,"td"),a(6),n(),o(7,"td"),a(8),n(),o(9,"td"),a(10),N(11,"horaPipe"),n()()),t&2){let e=i.$implicit;r(2),u(e.fecha),r(2),u(e.servicio.nombreServicio),r(2),u(e.empleado.dpi),r(2),u(e.costoTotal),r(2),u(q(11,5,e.hora))}}var S=class t{datos;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-tabla-clientes-gastos"]],inputs:{datos:"datos"},standalone:!0,features:[c],decls:23,vars:3,consts:[[1,"card-text"],[1,"table"],["scope","col"]],template:function(e,s){e&1&&(o(0,"p",0),a(1),n(),o(2,"p",0),a(3),n(),o(4,"p",0),a(5),n(),o(6,"table",1)(7,"thead")(8,"tr")(9,"th",2),a(10,"Fecha"),n(),o(11,"th",2),a(12,"Servicio"),n(),o(13,"th",2),a(14,"Empleado"),n(),o(15,"th",2),a(16,"Total"),n(),o(17,"th",2),a(18,"Hora"),n()()(),o(19,"tbody"),g(20,ne,12,7,"tr",null,oe),n()(),l(22,"br")),e&2&&(r(),v("Dpi cliente: ",s.datos.cliente.dpi,""),r(2),v("Nombre cliente: ",s.datos.cliente.nombre,""),r(2),v("Total gasto: ",s.datos.gastoTotal,""),r(15),F(s.datos.citas))},dependencies:[Z]})};function ae(t,i){if(t&1&&l(0,"app-form-cliente-gastos",0),t&2){let e=G();m("clienteMasGasto",e.clienteMasGasto)("informeCambio",e.informeCambio)("gastosClienteArreglo",e.clientes)}}function re(t,i){t&1&&a(0," Reporte de los 5 clientes que mas gastan ")}function se(t,i){t&1&&a(0," Reporte de los 5 clientes que menos gastan ")}function le(t,i){if(t&1&&(o(0,"h5",6),a(1),n()),t&2){let e=G(2);r(),v(" Filtrado por el cliente con dpi: ",e.informeCambio.getCampo(),`
`)}}function me(t,i){if(t&1&&l(0,"app-tabla-clientes-gastos",9),t&2){let e=i.$implicit;m("datos",e)}}function pe(t,i){t&1&&(o(0,"div",10),a(1," Sin registro de citas atendidas "),n())}function ce(t,i){if(t&1&&(o(0,"div",1),l(1,"app-boton-atras",2),o(2,"h2",3),f(3,re,1,0)(4,se,1,0),n(),l(5,"app-boton-importar-cliente-gastos",4),n(),l(6,"br")(7,"app-intervalo-vista",5),f(8,le,2,1,"h5",6),o(9,"div",1)(10,"div",7)(11,"div",8),g(12,me,1,1,"app-tabla-clientes-gastos",9,R,!1,pe,2,0,"div",10),n()()()),t&2){let e=G();r(),m("informe",e.informeCambio),r(2),C(e.clienteMasGasto?3:4),r(2),m("clienteMasGasto",e.clienteMasGasto)("informeCambio",e.informeCambio),r(2),m("informeCambio",e.informeCambio),r(),C(e.informeCambio.esCampoValido()?8:-1),r(4),F(e.clientes)}}var ee=class t{informeCambio=new U;clienteMasGasto=!0;clientes=[];router=b(B);ngOnInit(){this.clienteMasGasto=this.router.snapshot.data.clienteMasGasto??!0}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-vista-reporte-cliente-gastos"]],standalone:!0,features:[c],decls:3,vars:1,consts:[[3,"clienteMasGasto","informeCambio","gastosClienteArreglo"],[1,"d-flex","align-items-center","justify-content-center"],[3,"informe"],[1,"m-3"],[3,"clienteMasGasto","informeCambio"],[3,"informeCambio"],[1,"text-center"],[1,"card","w-50","m-3","shadow"],[1,"card-body","custom-card"],[3,"datos"],["role","alert",1,"alert","alert-warning","w-100"]],template:function(e,s){e&1&&(l(0,"app-informacion"),f(1,ae,1,3,"app-form-cliente-gastos",0)(2,ce,15,7)),e&2&&(r(),C(s.informeCambio.getCambio()?2:1))},dependencies:[L,x,X,Y,_,S]})};export{ee as VistaReporteClienteGastosComponent};
