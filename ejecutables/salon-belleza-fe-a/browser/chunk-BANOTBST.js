import{a as Y,b as J}from"./chunk-LPJ2IT5O.js";import{a as R}from"./chunk-6VF6MSZ4.js";import"./chunk-VG6MFNQK.js";import{a as O}from"./chunk-URET6IV6.js";import{a as L,b as m,c as P,d as U,e as H,f as x,g as z,h as j,l as k,m as B,n as G,o as F,p as $}from"./chunk-QEQSUI4L.js";import"./chunk-K7U5DLAY.js";import"./chunk-H2DLJ7WX.js";import{Ka as a,La as N,Va as f,Vb as w,W as S,Xa as s,Y as C,_a as v,ab as V,bb as M,cb as t,db as l,eb as p,fa as y,fb as q,ga as T,gb as g,hb as E,qb as n,tb as A,vb as b,xb as c}from"./chunk-TQRRVTAY.js";import"./chunk-2VMXMS7J.js";var D=class o{empleadosDisponibles;empleadosDelServicio;actualizarServicio;usuarioSeleccionado;informacion=S(F);agregrarEmpleado(){let r=this.usuarioSeleccionado.getUsuarioSeleccionado().dpi;this.actualizarServicio?this.agregarEmpleadoAlServicio(r):this.agregarAlaLista(r)}empleadoYaAgregado(i){for(let r of this.empleadosDelServicio)if(r.dpi===i)return!0;return!1}agregarAlaLista(i){let r=!1;for(let e of this.empleadosDisponibles)if(e.dpi===i){r=!0,this.empleadoYaAgregado(i)?this.informacion.informarError("El empleado ya ha sido agregado"):this.empleadosDelServicio.push(e);break}r||this.informacion.informarError("Error al agregar el empleado")}agregarEmpleadoAlServicio(i){}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=C({type:o,selectors:[["app-boton-agregar-empleado"]],inputs:{empleadosDisponibles:"empleadosDisponibles",empleadosDelServicio:"empleadosDelServicio",actualizarServicio:"actualizarServicio",usuarioSeleccionado:"usuarioSeleccionado"},standalone:!0,features:[b],decls:3,vars:0,consts:[[1,"d-flex","align-items-center","justify-content-center"],[1,"custom-button","w-50",3,"click"]],template:function(r,e){r&1&&(t(0,"div",0)(1,"button",1),g("click",function(){return e.agregrarEmpleado()}),n(2,"Agregar empleado"),l()())}})};var X=(o,i)=>i.dpi;function Z(o,i){if(o&1){let r=q();t(0,"li",1),n(1),t(2,"button",2),g("click",function(){let d=y(r).$implicit,u=E();return T(u.borrarEmpleado(d.dpi))}),l()()}if(o&2){let r=i.$implicit;a(),A(" ",r.nombre," (",r.dpi,") ")}}var I=class o{empleadosDelServicio;actualizarServicio;idServicio;informacion=S(F);borrarEmpleado(i){this.actualizarServicio||this.borrarDelaLista(i)}borrarDelaLista(i){let r=this.empleadosDelServicio.findIndex(e=>e.dpi===i);r!==-1?this.empleadosDelServicio.splice(r,1):this.informacion.informarError("El empleado no se encuentra en la lista")}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=C({type:o,selectors:[["app-lista-empleados-servicio"]],inputs:{empleadosDelServicio:"empleadosDelServicio",actualizarServicio:"actualizarServicio",idServicio:"idServicio"},standalone:!0,features:[b],decls:3,vars:0,consts:[[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],["type","button","aria-label","Close",1,"btn-close","ms-auto",3,"click"]],template:function(r,e){r&1&&(t(0,"ul",0),V(1,Z,3,2,"li",1,X),l()),r&2&&(a(),M(e.empleadosDelServicio))}})};var _=(o,i)=>({"mb-5":o,"mb-3":i}),h=(o,i)=>({"is-invalid":o,"is-valid":i});function ee(o,i){o&1&&n(0," Ingrese un nombre ")}function ie(o,i){o&1&&n(0," Ingrese un nombre valido ")}function oe(o,i){o&1&&n(0," Ingrese una descripcion del servicio ")}function re(o,i){o&1&&n(0," descripcion demasiado corta ")}function ae(o,i){o&1&&n(0," Ingrese el precio del servicio ")}function te(o,i){o&1&&n(0," Ingrese un precio valido ")}function ne(o,i){o&1&&n(0," Ingrese una hora en el rango de 1 a 4 horas ")}function le(o,i){o&1&&n(0," Ingrese la duracion del servicio ")}function se(o,i){o&1&&n(0," Ingrese una duracion valida ")}function me(o,i){o&1&&n(0," Ingrese la foto del servicio ")}function ce(o,i){o&1&&n(0," foto demasiado grande, escoja una menor a 64kb ")}function de(o,i){o&1&&n(0," Ingrese el catalogo del servicio ")}function pe(o,i){o&1&&n(0," foto demasiado grande, escoja una menor a 64kb ")}function ve(o,i){if(o&1&&p(0,"br")(1,"app-boton-agregar-empleado",28),o&2){let r=E();a(),s("empleadosDisponibles",r.empleados)("empleadosDelServicio",r.empleadosDelServicio)("usuarioSeleccionado",r.empleadoSeleccionado)("actualizarServicio",!1)}}var W=class o{constructor(i){this.formBuilder=i;this.servicioForm=this.formBuilder.group({nombreServicio:["",[m.required,m.minLength(6),m.maxLength(200)]],descripcion:["",[m.required,m.minLength(20)]],precio:["",[m.required,m.min(.01)]],horas:["",[m.min(1),m.max(4)]],minutos:["",[m.required,m.min(1),m.max(59)]],foto:["",[m.required]],catalogo:["",[m.required]]}),this.validadorForm=new O(this.servicioForm)}informacion=S(F);servicioForm;validadorForm;foto=null;catalogo=null;empleadosDelServicio=[];empleados;empleadoSeleccionado=new J;_servicioService=S(R);ngOnInit(){this._servicioService.obtenerEmpleados().subscribe({next:i=>{this.empleados=i},error:i=>{console.error("Error al obtener los empleados:",i),this.informacion.informarError("Error al obtener los empleados")}})}enviar(){if(console.log(this.servicioForm.value),this.servicioForm.valid&&this.foto!==null&&this.catalogo!==null){if(this.empleadosDelServicio.length===0){this.informacion.informarError("Agregar al menos un empleado");return}let i=this.obtenerHoras(),r=this.obtenerMinutos(),e={idServicio:0,nombreServicio:this.servicioForm.value.nombreServicio,descripcion:this.servicioForm.value.descripcion,precio:this.servicioForm.value.precio,duracion:`${i}:${r}`,empleados:this.empleadosDelServicio,activo:!0},d=new FormData;d.append("servicio",JSON.stringify(e)),d.append("foto",this.foto),d.append("catalogo",this.catalogo),this._servicioService.crearServicio(d).subscribe({next:()=>{this.servicioForm.reset(),this.foto=null,this.catalogo=null,this.empleadosDelServicio.length=0,this.informacion.informarExito("Servicio creado con \xE9xito")},error:u=>{console.error("Error al crear el servicio:",u),this.informacion.informarError(u.error.mensaje||"Error al crear el servicio")}})}else this.servicioForm.markAllAsTouched(),this.servicioForm.value,this.informacion.informarError("Completar los campos requeridos")}obtenerHoras(){let i=this.servicioForm.value.horas.toString();return i.length===0?i="00":i.length===1&&(i="0"+i),i}obtenerMinutos(){let i=this.servicioForm.value.minutos.toString();return i.length===1&&(i="0"+i),i}fotoSeleccionada(i){let r=i.target;r.files&&r.files.length>0?this.foto=r.files[0]:this.foto=null}catalogoSeleccionado(i){let r=i.target;r.files&&r.files.length>0?this.catalogo=r.files[0]:this.catalogo=null}faltaFoto(){return this.validadorForm.hasErrors("foto","required")&&this.foto===null}esFotoValida(){return this.validadorForm.esValido("foto")&&this.foto!==null}faltaCatalogo(){return this.validadorForm.hasErrors("catalogo","required")&&this.catalogo===null}esCatalogoValido(){return this.validadorForm.esValido("catalogo")&&this.catalogo!==null}faltaNombreServicio(){return this.validadorForm.hasErrors("nombreServicio","required")}esNombreServicioInvalido(){return this.validadorForm.hasErrors("nombreServicio","minlength")||this.validadorForm.hasErrors("nombreServicio","maxlength")}esNombreServicioValido(){return this.validadorForm.esValido("nombreServicio")}faltaDescripcion(){return this.validadorForm.hasErrors("descripcion","required")}esDescripcionInvalida(){return this.validadorForm.hasErrors("descripcion","minlength")}esDescripcionValida(){return this.validadorForm.esValido("descripcion")}faltaPrecio(){return this.validadorForm.hasErrors("precio","required")}esPrecioInvalido(){return this.validadorForm.hasErrors("precio","min")}esPrecioValido(){return this.validadorForm.esValido("precio")}esHoraInvalida(){return this.validadorForm.hasErrors("horas","min")||this.validadorForm.hasErrors("horas","max")}esHoraValida(){return this.validadorForm.esValido("horas")}faltaMinutos(){return this.validadorForm.hasErrors("minutos","required")}esMinutosInvalido(){return this.validadorForm.hasErrors("minutos","min")||this.validadorForm.hasErrors("minutos","max")}esMinutosValido(){return this.validadorForm.esValido("minutos")}static \u0275fac=function(r){return new(r||o)(N(B))};static \u0275cmp=C({type:o,selectors:[["app-form-servicio"]],standalone:!0,features:[b],decls:63,vars:65,consts:[[1,"d-flex","align-items-center","justify-content-center"],[1,"card","m-3","custom-card","shadow",2,"width","60%"],[1,"card-body"],[1,"row"],[1,"col-md-5"],[1,"card-title","text-center","mb-3"],["novalidate","",1,"needs-validation",3,"submit","formGroup"],[1,"position-relative",3,"ngClass"],["for","validationTooltip01",1,"form-label"],["type","text","id","validationTooltip01","formControlName","nombreServicio","required","",1,"form-control",3,"ngClass"],[1,"invalid-tooltip"],["for","validationTooltip02",1,"form-label"],["rows","3","id","validationTooltip02","formControlName","descripcion","required","",1,"form-control",3,"ngClass"],["for","validationTooltip03",1,"form-label"],["type","number","step","0.01","id","validationTooltip03","formControlName","precio","required","",1,"form-control",3,"ngClass"],["for","validationTooltip04",1,"form-label"],[1,"position-relative","input-group",3,"ngClass"],["type","number","id","validationTooltip04","formControlName","horas","placeholder","Horas",1,"form-control",3,"ngClass"],[1,"input-group-text"],["type","number","placeholder","Minutos","id","validationTooltip05","formControlName","minutos","required","",1,"form-control",3,"ngClass"],["for","validationTooltip05",1,"form-label"],["type","file","accept","image/*","id","validationTooltip05","formControlName","foto","required","",1,"form-control",3,"change","ngClass"],["type","file","accept","application/pdf","id","validationTooltip05","formControlName","catalogo","required","",1,"form-control",3,"change","ngClass"],[1,"mb-3","d-flex","justify-content-center"],["type","submit",1,"custom-button"],[1,"col-md-7"],[3,"empleadosDisponibles","seleccionado"],[3,"empleadosDelServicio","actualizarServicio"],[3,"empleadosDisponibles","empleadosDelServicio","usuarioSeleccionado","actualizarServicio"]],template:function(r,e){r&1&&(p(0,"app-informacion"),t(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"h5",5),n(7,"Crear nuevo servicio"),l(),t(8,"form",6),g("submit",function(){return e.enviar()}),t(9,"div",7)(10,"label",8),n(11,"Nombre del servicio"),l(),p(12,"input",9),t(13,"div",10),f(14,ee,1,0)(15,ie,1,0),l()(),t(16,"div",7)(17,"label",11),n(18,"Descripcion del servicio"),l(),p(19,"textarea",12),t(20,"div",10),f(21,oe,1,0)(22,re,1,0),l()(),t(23,"div",7)(24,"label",13),n(25,"Precio del servicio"),l(),p(26,"input",14),t(27,"div",10),f(28,ae,1,0)(29,te,1,0),l()(),t(30,"label",15),n(31,"Duracion del servicio"),l(),t(32,"div",16),p(33,"input",17),t(34,"span",18),n(35,":"),l(),p(36,"input",19),t(37,"div",10),f(38,ne,1,0)(39,le,1,0)(40,se,1,0),l()(),t(41,"div",7)(42,"label",20),n(43,"Fotografia del servicio"),l(),t(44,"input",21),g("change",function(u){return e.fotoSeleccionada(u)}),l(),t(45,"div",10),f(46,me,1,0)(47,ce,1,0),l()(),t(48,"div",7)(49,"label",20),n(50,"Catalogo del servicio"),l(),t(51,"input",22),g("change",function(u){return e.catalogoSeleccionado(u)}),l(),t(52,"div",10),f(53,de,1,0)(54,pe,1,0),l()(),t(55,"div",23)(56,"button",24),n(57," Crear servicio "),l()()()(),t(58,"div",25),p(59,"app-form-empleados",26),f(60,ve,2,4),p(61,"br")(62,"app-lista-empleados-servicio",27),l()()()()()),r&2&&(a(8),s("formGroup",e.servicioForm),a(),s("ngClass",c(26,_,e.faltaNombreServicio()||e.esNombreServicioInvalido(),!(e.faltaNombreServicio()||e.esNombreServicioInvalido()))),a(3),s("ngClass",c(29,h,e.faltaNombreServicio()||e.esNombreServicioInvalido(),e.esNombreServicioValido())),a(2),v(e.faltaNombreServicio()?14:-1),a(),v(e.esNombreServicioInvalido()?15:-1),a(),s("ngClass",c(32,_,e.faltaDescripcion()||e.esDescripcionInvalida(),!(e.faltaDescripcion()||e.esDescripcionInvalida()))),a(3),s("ngClass",c(35,h,e.faltaDescripcion()||e.esDescripcionInvalida(),e.esDescripcionValida())),a(2),v(e.faltaDescripcion()?21:22),a(2),s("ngClass",c(38,_,e.faltaPrecio()||e.esPrecioInvalido(),!(e.faltaPrecio()||e.esPrecioInvalido()))),a(3),s("ngClass",c(41,h,e.faltaPrecio()||e.esPrecioInvalido(),e.esPrecioValido())),a(2),v(e.faltaPrecio()?28:29),a(4),s("ngClass",c(44,_,e.esHoraInvalida()||e.faltaMinutos()||e.esMinutosInvalido(),!(e.esHoraInvalida()||e.faltaMinutos()||e.esMinutosInvalido()))),a(),s("ngClass",c(47,h,e.esHoraInvalida(),(e.esHoraValida()||e.esMinutosValido())&&!e.esHoraInvalida())),a(3),s("ngClass",c(50,h,e.faltaMinutos()||e.esMinutosInvalido(),e.esMinutosValido())),a(2),v(e.esHoraInvalida()?38:e.faltaMinutos()?39:40),a(3),s("ngClass",c(53,_,e.faltaFoto(),!e.faltaFoto())),a(3),s("ngClass",c(56,h,e.faltaFoto(),e.esFotoValida())),a(2),v(e.faltaFoto()?46:47),a(2),s("ngClass",c(59,_,e.faltaCatalogo(),!e.faltaCatalogo())),a(3),s("ngClass",c(62,h,e.faltaCatalogo(),e.esCatalogoValido())),a(2),v(e.faltaCatalogo()?53:54),a(6),s("empleadosDisponibles",e.empleados)("seleccionado",e.empleadoSeleccionado),a(),v(e.empleadoSeleccionado.usuarioNulo()?-1:60),a(2),s("empleadosDelServicio",e.empleadosDelServicio)("actualizarServicio",!1))},dependencies:[$,G,H,L,x,P,U,k,z,j,w,Y,D,I]})};export{W as FormServicioComponent};
