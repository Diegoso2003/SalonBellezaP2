import{a as J}from"./chunk-DGXXTX47.js";import{a as U}from"./chunk-2MZD7B76.js";import{a as P,b as O}from"./chunk-OCPFQW2A.js";import{a as z}from"./chunk-URET6IV6.js";import{a as N,b as x,c as R,d as D,e as k,g as B,h as q,m as j,n as G,o as H,p as $}from"./chunk-QEQSUI4L.js";import"./chunk-K7U5DLAY.js";import{c as w}from"./chunk-H2DLJ7WX.js";import{Ka as s,La as M,Va as d,Vb as T,W as u,Xa as c,Y as l,_a as f,ab as h,bb as C,cb as t,db as o,eb as m,gb as E,ha as y,hb as _,qb as a,rb as b,sb as F,vb as p,xb as v}from"./chunk-TQRRVTAY.js";import"./chunk-2VMXMS7J.js";var K=(n,e)=>({"mb-5":n,"mb-3":e}),L=(n,e)=>({"is-invalid":n,"is-valid":e});function W(n,e){n&1&&a(0," Reporte de los 5 anuncios mas vistos ")}function X(n,e){n&1&&a(0," Reporte de los 5 anuncios menos vistos ")}var V=class n{constructor(e){this.formBuilder=e;this.consultaForm=this.formBuilder.group({fechaInicio:["",[x.pattern(/^\d{4}-\d{2}-\d{2}$/)]],fechaFin:["",[x.pattern(/^\d{4}-\d{2}-\d{2}$/)]]}),this.validador=new z(this.consultaForm)}consultaForm;validador;informacion=u(H);marketingService=u(J);anunciosMasVistos;anuncios;informeCambio;enviar(){this.vaciarFechas(),this.consultaForm.valid?this.mandarInfo():(this.consultaForm.markAllAsTouched(),this.informacion.informarError("ingresar correctamente los datos solicitados"))}mandarInfo(){let e=this.armarConsulta();this.anunciosMasVistos?this.marketingService.anunciosMasVistos(e).subscribe({next:i=>{this.agregarAnuncios(i),this.informarCambio(e)},error:i=>{this.informacion.informarError(i.error.mensaje||"error al cargar los anuncios")}}):this.marketingService.anunciosMenosVistos(e).subscribe({next:i=>{this.agregarAnuncios(i),this.informarCambio(e)},error:i=>{this.informacion.informarError(i.error.mensaje||"error al cargar los anuncios")}})}agregarAnuncios(e){this.anuncios.length=0,this.anuncios.push(...e)}informarCambio(e){this.informeCambio.setFechaInicio(e.fechaInicio||""),this.informeCambio.setFechaFin(e.fechaFin||""),this.informeCambio.setCambio(!0)}vaciarFechas(){this.informeCambio.setFechaInicio(""),this.informeCambio.setFechaFin("")}armarConsulta(){let e=this.consultaForm.get("fechaInicio")?.value,i=this.consultaForm.get("fechaFin")?.value,r={};return e!==""&&(r.fechaInicio=e),i!==""&&(r.fechaFin=i),r}esFechaInicioInvalida(){return this.validador.hasErrors("fechaInicio","pattern")}esFechaFinInvalida(){return this.validador.hasErrors("fechaFin","pattern")}esFechaInicioValida(){return this.validador.esValido("fechaInicio")}esFechaFinValida(){return this.validador.esValido("fechaFin")}static \u0275fac=function(i){return new(i||n)(M(j))};static \u0275cmp=l({type:n,selectors:[["app-form-anuncios-vistos"]],inputs:{anunciosMasVistos:"anunciosMasVistos",anuncios:"anuncios",informeCambio:"informeCambio"},standalone:!0,features:[p],decls:22,vars:18,consts:[[1,"d-flex","align-items-center","justify-content-center"],[1,"card","w-25","m-3","shadow"],[1,"card-body","custom-card"],[1,"card-title","text-center","mb-3"],["novalidate","",1,"needs-validation",3,"submit","formGroup"],[1,"position-relative",3,"ngClass"],["for","validationTooltip02",1,"form-label"],["type","date","id","validationTooltip02","formControlName","fechaInicio",1,"form-control",3,"ngClass"],[1,"invalid-tooltip"],["for","validationTooltip01",1,"form-label"],["type","date","id","validationTooltip01","formControlName","fechaFin",1,"form-control",3,"ngClass"],[1,"mb-3","d-flex","justify-content-center"],["type","submit",1,"custom-button"]],template:function(i,r){i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),d(4,W,1,0)(5,X,1,0),o(),t(6,"form",4),E("submit",function(){return r.enviar()}),t(7,"div",5)(8,"label",6),a(9,"Fecha inicio"),o(),m(10,"input",7),t(11,"div",8),a(12,"Ingrese una fecha valida"),o()(),t(13,"div",5)(14,"label",9),a(15,"Fecha fin"),o(),m(16,"input",10),t(17,"div",8),a(18,"Ingrese una fecha valida"),o()(),t(19,"div",11)(20,"button",12),a(21,"Realizar consulta"),o()()()()()()),i&2&&(s(4),f(r.anunciosMasVistos?4:5),s(2),c("formGroup",r.consultaForm),s(),c("ngClass",v(6,K,r.esFechaInicioInvalida(),!r.esFechaInicioInvalida())),s(3),c("ngClass",v(9,L,r.esFechaInicioInvalida(),r.esFechaInicioValida())),s(3),c("ngClass",v(12,K,r.esFechaFinInvalida(),!r.esFechaFinInvalida())),s(3),c("ngClass",v(15,L,r.esFechaFinInvalida(),r.esFechaFinValida())))},dependencies:[G,k,N,R,D,B,q,T]})};var Y=(n,e)=>e.idHistorial;function Z(n,e){if(n&1&&(t(0,"tr")(1,"td"),a(2),o(),t(3,"td"),a(4),o(),t(5,"td"),a(6),o()()),n&2){let i=e.$implicit;s(2),b(i.url),s(2),b(i.fechaPublicacion),s(2),b(i.cantidad)}}var I=class n{anuncio;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=l({type:n,selectors:[["app-tabla-anuncios"]],inputs:{anuncio:"anuncio"},standalone:!0,features:[p],decls:19,vars:3,consts:[[1,"card-text"],[1,"table"],["scope","col"]],template:function(i,r){i&1&&(t(0,"p",0),a(1),o(),t(2,"p",0),a(3),o(),t(4,"p",0),a(5),o(),t(6,"table",1)(7,"thead")(8,"tr")(9,"th",2),a(10,"Url donde se mostro"),o(),t(11,"th",2),a(12,"Fecha"),o(),t(13,"th",2),a(14,"Cantidad"),o()()(),t(15,"tbody"),h(16,Z,7,3,"tr",null,Y),o()(),m(18,"br")),i&2&&(s(),F("Id del anuncio: ",r.anuncio.idAnuncio,""),s(2),F("Tipo de anuncio: ",r.anuncio.tipo,""),s(2),F("Veces que se mostro: ",r.anuncio.totalMostrado,""),s(11),C(r.anuncio.historial))}})};var g=class n{informeCambio;anunciosMasVistos;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=l({type:n,selectors:[["app-boton-importar"]],inputs:{informeCambio:"informeCambio",anunciosMasVistos:"anunciosMasVistos"},standalone:!0,features:[p],decls:4,vars:0,consts:[["type","button",1,"btn","btn-sm","custom-button"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-filetype-pdf"],["fill-rule","evenodd","d","M14 4.5V14a2 2 0 0 1-2 2h-1v-1h1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5zM1.6 11.85H0v3.999h.791v-1.342h.803q.43 0 .732-.173.305-.175.463-.474a1.4 1.4 0 0 0 .161-.677q0-.375-.158-.677a1.2 1.2 0 0 0-.46-.477q-.3-.18-.732-.179m.545 1.333a.8.8 0 0 1-.085.38.57.57 0 0 1-.238.241.8.8 0 0 1-.375.082H.788V12.48h.66q.327 0 .512.181.185.183.185.522m1.217-1.333v3.999h1.46q.602 0 .998-.237a1.45 1.45 0 0 0 .595-.689q.196-.45.196-1.084 0-.63-.196-1.075a1.43 1.43 0 0 0-.589-.68q-.396-.234-1.005-.234zm.791.645h.563q.371 0 .609.152a.9.9 0 0 1 .354.454q.118.302.118.753a2.3 2.3 0 0 1-.068.592 1.1 1.1 0 0 1-.196.422.8.8 0 0 1-.334.252 1.3 1.3 0 0 1-.483.082h-.563zm3.743 1.763v1.591h-.79V11.85h2.548v.653H7.896v1.117h1.606v.638z"]],template:function(i,r){i&1&&(t(0,"button",0),a(1," Importar reporte "),y(),t(2,"svg",1),m(3,"path",2),o()())}})};var ii=(n,e)=>e.idAnuncio;function ei(n,e){if(n&1&&m(0,"app-form-anuncios-vistos",0),n&2){let i=_();c("anunciosMasVistos",i.anunciosMasVistos)("anuncios",i.anuncios)("informeCambio",i.informeCambio)}}function ni(n,e){n&1&&a(0," Reporte de los 5 anuncios mas vistos ")}function ti(n,e){n&1&&a(0," Reporte de los 5 anuncios menos vistos ")}function oi(n,e){if(n&1&&m(0,"app-tabla-anuncios",8),n&2){let i=e.$implicit;c("anuncio",i)}}function ai(n,e){n&1&&(t(0,"div",9),a(1," Sin anuncios mostrados "),o())}function ri(n,e){if(n&1&&(t(0,"div",1),m(1,"app-boton-atras",2),t(2,"h2",3),d(3,ni,1,0)(4,ti,1,0),o(),m(5,"app-boton-importar",4),o(),m(6,"br")(7,"app-intervalo-vista",5),t(8,"div",1)(9,"div",6)(10,"div",7),h(11,oi,1,1,"app-tabla-anuncios",8,ii,!1,ai,2,0,"div",9),o()()()),n&2){let i=_();s(),c("informe",i.informeCambio),s(2),f(i.anunciosMasVistos?3:4),s(2),c("informeCambio",i.informeCambio)("anunciosMasVistos",i.anunciosMasVistos),s(2),c("informeCambio",i.informeCambio),s(4),C(i.anuncios)}}var Q=class n{informeCambio=new P;anuncios=[];anunciosMasVistos=!1;route=u(w);ngOnInit(){this.anunciosMasVistos=this.route.snapshot.data.anunciosMasVistos??!0}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=l({type:n,selectors:[["app-vista-reporte-anuncio-vista"]],standalone:!0,features:[p],decls:3,vars:1,consts:[[3,"anunciosMasVistos","anuncios","informeCambio"],[1,"d-flex","align-items-center","justify-content-center"],[3,"informe"],[1,"m-3"],[3,"informeCambio","anunciosMasVistos"],[3,"informeCambio"],[1,"card","w-50","m-3","shadow"],[1,"card-body","custom-card"],[3,"anuncio"],["role","alert",1,"alert","alert-warning","w-100"]],template:function(i,r){i&1&&(m(0,"app-informacion"),d(1,ei,1,3,"app-form-anuncios-vistos",0)(2,ri,14,6)),i&2&&(s(),f(r.informeCambio.getCambio()?2:1))},dependencies:[$,V,O,I,g,U]})};export{Q as VistaReporteAnuncioVistaComponent};
