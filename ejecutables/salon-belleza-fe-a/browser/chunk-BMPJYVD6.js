import{a as J}from"./chunk-6VINH2C6.js";import{a as H}from"./chunk-BCQ6RXAA.js";import{a as P}from"./chunk-5SBUVE6J.js";import"./chunk-2ZKC73YP.js";import{a as q}from"./chunk-2MZD7B76.js";import{a as k,b as z}from"./chunk-OCPFQW2A.js";import{a as $}from"./chunk-URET6IV6.js";import{a as E,b as g,c as T,d as R,e as N,g as w,h as D,m as j,n as B,o as A,p as M}from"./chunk-QEQSUI4L.js";import"./chunk-K7U5DLAY.js";import{$a as I,Ka as n,La as S,Va as h,Vb as V,W as C,Xa as c,Y as d,_a as b,ab as G,bb as _,cb as t,db as r,eb as m,gb as x,hb as v,qb as s,sb as F,vb as f,wb as y,xb as p}from"./chunk-TQRRVTAY.js";import"./chunk-2VMXMS7J.js";var K=(a,e)=>({"mb-5":a,"mb-3":e}),L=(a,e)=>({"is-invalid":a,"is-valid":e}),W=a=>({"is-valid":a}),u=class a{constructor(e){this.fb=e;this.servicioGananciasForm=this.fb.group({fechaInicio:["",[g.pattern(/^\d{4}-\d{2}-\d{2}$/)]],fechaFin:["",[g.pattern(/^\d{4}-\d{2}-\d{2}$/)]],servicio:[""]}),this.validador=new $(this.servicioGananciasForm)}servicioGananciasForm;validador;informacion=C(A);adminService=C(P);informeCambio;servicios;enviar(){this.informeCambio.vaciarFechas(),this.servicioGananciasForm.valid?this.mandarInfo():(this.informacion.informarError("ingresar correctamente los datos ingresados"),this.servicioGananciasForm.markAllAsTouched())}mandarInfo(){let e=this.armarConsulta();this.adminService.obtenerServiciosGanancia(e).subscribe({next:i=>{this.agregarReporte(i),this.informarCambio(e)},error:i=>{this.informacion.informarError(i.error.mensaje||"Error al obtener el reporte")}})}agregarReporte(e){this.servicios.length=0,this.servicios.push(...e);let i=e.reduce((o,l)=>o+l.totalGanancias,0);this.informeCambio.setSuma(i)}informarCambio(e){this.informeCambio.setFechaInicio(e.fechaInicio||""),this.informeCambio.setFechaFin(e.fechaFin||""),this.informeCambio.setCampo(e.campo||""),this.informeCambio.setCambio(!0)}armarConsulta(){let e=this.servicioGananciasForm.get("fechaInicio")?.value,i=this.servicioGananciasForm.get("fechaFin")?.value,o=this.servicioGananciasForm.get("servicio")?.value,l={};return e!==""&&(l.fechaInicio=e),i!==""&&(l.fechaFin=i),o!==""&&(l.campo=o),l}esFechaInicioInvalida(){return this.validador.hasErrors("fechaInicio","pattern")}esFechaFinInvalida(){return this.validador.hasErrors("fechaFin","pattern")}esFechaInicioValida(){return this.validador.esValido("fechaInicio")}esFechaFinValida(){return this.validador.esValido("fechaFin")}esServicioValido(){return this.validador.esValido("servicio")}static \u0275fac=function(i){return new(i||a)(S(j))};static \u0275cmp=d({type:a,selectors:[["app-form-servicio-ganancias"]],inputs:{informeCambio:"informeCambio",servicios:"servicios"},standalone:!0,features:[f],decls:27,vars:20,consts:[[1,"d-flex","align-items-center","justify-content-center"],[1,"card","w-25","m-3","shadow"],[1,"card-body","custom-card"],[1,"card-title","text-center","mb-3"],["novalidate","",1,"needs-validation",3,"submit","formGroup"],[1,"position-relative",3,"ngClass"],["for","validationTooltip02",1,"form-label"],["type","date","id","validationTooltip02","formControlName","fechaInicio",1,"form-control",3,"ngClass"],[1,"invalid-tooltip"],["for","validationTooltip01",1,"form-label"],["type","date","id","validationTooltip01","formControlName","fechaFin",1,"form-control",3,"ngClass"],[1,"position-relative","mb-3"],["for","validationTooltip04",1,"form-label"],["type","text","id","validationTooltip04","formControlName","servicio",1,"form-control",3,"ngClass"],[1,"mb-3","d-flex","justify-content-center"],["type","submit",1,"custom-button"]],template:function(i,o){i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),s(4," Reporte de ganancias por servicio "),r(),t(5,"form",4),x("submit",function(){return o.enviar()}),t(6,"div",5)(7,"label",6),s(8,"Fecha inicio"),r(),m(9,"input",7),t(10,"div",8),s(11,"Ingrese una fecha valida"),r()(),t(12,"div",5)(13,"label",9),s(14,"Fecha fin"),r(),m(15,"input",10),t(16,"div",8),s(17,"Ingrese una fecha valida"),r()(),t(18,"div",11)(19,"label",12),s(20,"Servicio"),r(),m(21,"input",13),t(22,"div",8),s(23,"Ingrese un servicio valido"),r()(),t(24,"div",14)(25,"button",15),s(26,"Realizar consulta"),r()()()()()()),i&2&&(n(5),c("formGroup",o.servicioGananciasForm),n(),c("ngClass",p(6,K,o.esFechaInicioInvalida(),!o.esFechaInicioInvalida())),n(3),c("ngClass",p(9,L,o.esFechaInicioInvalida(),o.esFechaInicioValida())),n(3),c("ngClass",p(12,K,o.esFechaFinInvalida(),!o.esFechaFinInvalida())),n(3),c("ngClass",p(15,L,o.esFechaFinInvalida(),o.esFechaFinValida())),n(6),c("ngClass",y(18,W,o.esServicioValido())))},dependencies:[V,B,N,E,T,R,w,D]})};function X(a,e){if(a&1&&m(0,"app-form-servicio-ganancias",0),a&2){let i=v();c("informeCambio",i.informeCambio)("servicios",i.servicios)}}function Y(a,e){if(a&1&&(t(0,"h5",5),s(1),r()),a&2){let i=v(2);n(),F(" Filtrado por el servicio: ",i.informeCambio.getCampo(),`
`)}}function Z(a,e){if(a&1&&m(0,"app-tabla-servicio-ganancias",9),a&2){let i=e.$implicit;c("servicio",i)}}function ii(a,e){a&1&&(t(0,"div",10),s(1," Sin registro de citas atendidas "),r())}function ei(a,e){if(a&1&&(t(0,"div",1),m(1,"app-boton-atras",2),t(2,"h2",3),s(3,"Reporte de ganancias por servicio"),r(),m(4,"app-boton-importar-servicio-ganancias",4),r(),m(5,"br")(6,"app-intervalo-vista",4),h(7,Y,2,1,"h5",5),t(8,"div",1)(9,"div",6)(10,"div",7)(11,"p",8),s(12),r(),G(13,Z,1,1,"app-tabla-servicio-ganancias",9,I,!1,ii,2,0,"div",10),r()()()),a&2){let i=v();n(),c("informe",i.informeCambio),n(3),c("informeCambio",i.informeCambio),n(2),c("informeCambio",i.informeCambio),n(),b(i.informeCambio.esCampoValido()?7:-1),n(5),F("Ganancia Total: ",i.informeCambio.getSuma(),""),n(),_(i.servicios)}}var O=class a{informeCambio=new k;servicios=[];static \u0275fac=function(i){return new(i||a)};static \u0275cmp=d({type:a,selectors:[["app-vista-reporte-ganancias-servicio"]],standalone:!0,features:[f],decls:3,vars:1,consts:[[3,"informeCambio","servicios"],[1,"d-flex","align-items-center","justify-content-center"],[3,"informe"],[1,"m-3"],[3,"informeCambio"],[1,"text-center"],[1,"card","w-50","m-3","shadow"],[1,"card-body","custom-card"],[1,"card-text"],[3,"servicio"],["role","alert",1,"alert","alert-warning","w-100"]],template:function(i,o){i&1&&(m(0,"app-informacion"),h(1,X,1,2,"app-form-servicio-ganancias",0)(2,ei,16,6)),i&2&&(n(),b(o.informeCambio.getCambio()?2:1))},dependencies:[M,u,z,H,q,J]})};export{O as VistaReporteGananciasServicioComponent};
